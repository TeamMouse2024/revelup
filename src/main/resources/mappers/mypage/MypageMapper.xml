<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.revelup.mypage.model.dao.MypageMapper">


    <resultMap id="login" type="com.revelup.user.model.dto.LoginUserDTO">
        <id property="userId" column="USER_ID"/>
        <result property="userName" column="USER_NAME"/>
        <result property="userPw" column="USER_PW"/>
        <result property="userPhone" column="USER_PHONE"/>
        <result property="userAdd" column="USER_ADD"/>
        <result property="userEmail" column="USER_EMAIL"/>
        <result property="userRole" column="USER_ROLE"/>
    </resultMap>

    <!--    FND_INFO ResultMap 펀딩정보 -->
    <resultMap id="fndInfoResultMap" type="com.revelup.funding.model.dto.FundingInfoDTO">
        <id property="fndCode" column="FND_CODE" />
        <result property="userId" column="USER_ID" />
        <result property="fndName" column="FND_NAME" />
        <result property="fndEndDt" column="FND_END_DT" />
        <result property="goalAmt" column="GOAL_AMT" />
        <result property="fndDescr" column="FND_DESCR" />
        <result property="successAmt" column="SUCCESS_AMT" />
        <result property="fndDelYn" column="FND_DEL_YN" />
        <result property="fndPrgStat" column="FND_PRG_STAT" />
    </resultMap>

    <!--    fnd_file ResultMap 펀딩 파일 -->
    <resultMap id="fndFile" type="com.revelup.funding.model.dto.FundingFileDTO" >
        <id property="fileCode" column="FILE_CODE" />
        <result property="fndCode" column="FND_CODE" />
        <result property="fndFileLoc" column="FND_FILE_LOC" />
        <result property="fndOrgFile" column="FND_ORG_FILE" />
        <result property="fndSaveFile" column="FND_SAVE_FILE" />
        <result property="fileDiv" column="FILE_DIV" />
    </resultMap>

    <!--    gift ResultMap 선물 -->
    <resultMap id="giftResultMap" type="com.revelup.funding.model.dto.GiftDTO">
        <id property="fndCode" column="FND_CODE" />
        <result property="giftPrice" column="GIFT_PRICE" />
        <result property="giftName" column="GIFT_NAME" />
        <result property="giftProdQty" column="GIFT_PROD_QTY" />
    </resultMap>

    <!--    PLG ResultMap 후원 -->
    <resultMap id="payResultMap" type="com.revelup.pay.model.dto.PayDTO">
        <id property="plgCode" column="PLG_CODE" />
        <result property="userId" column="USER_ID" />
        <result property="fndCode" column="FND_CODE" />
        <result property="giftQty" column="GIFT_QTY" />
        <result property="plgDttm" column="PLG_DTTM" />
        <result property="plgPrice" column="PLG_PRICE" />
        <result property="plgCanDt" column="PLG_CAN_DT" />
    </resultMap>


    <select id="selectAllPlgList" resultMap="com.revelup.pay.model.dto.PayDTO">
<!--        SELECT DATE_FORMAT(P.PLG_DTTM,'%Y-%m-%d')-->
        SELECT P.PLG_DTTM
                ,P.PLG_CODE
                ,F.FND_CODE0
                ,F.FND_NAME
                ,G.GIFT_NAME
                ,p.GIFT_QTY
                ,G.GIFT_PRICE
                ,P.PLG_PRICE
        FROM PLG P
        LEFT JOIN FND_INFO F ON P.FND_CODE = F.FND_CODE
        LEFT JOIN GIFT G ON G.FND_CODE = F.FND_CODE
    </select>


    <select id="sttrFndPro" resultMap="com.revelup.funding.model.dao.FundingMapper">
        SELECT P.PLG_DTTM
                ,F.FND_NAME
                ,G.GIFT_NAME
                ,F.SUCCESS_AMT
                ,F.FND_END_DT
                ,FND_CODE
                ,U.USER_NAME
                ,P.PLG_PRICE
                ,P.PLG_DTTM
                ,U.USER_ADD
                ,D.DELIV_STAT
                ,D.TRACKING_NO
          FROM
         WHERE FND_CODE = @{ fndCode }

    </select>


</mapper>
